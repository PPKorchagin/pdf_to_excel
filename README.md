# pdf_to_excel

WebGUI (Flask) проект для обработки **одного или нескольких PDF** и формирования Excel-отчета.

## Возможности

- Загрузка **нескольких PDF** через браузер.
- Извлечение таблиц из PDF через `tabula-py`.
- Извлечение номера документа из текста PDF (PyPDF2 + regex).
- Нормализация данных:
  - `код` очищается от пробелов и `.0`
  - значения количества/сумм приводятся к числу (`"1 234,56"` → `1234.56`)
- **Суммирование строк с одинаковым `код` внутри каждого PDF**.
- Объединение результатов нескольких PDF в одну таблицу по `код`.
- Добавляются итоги:
  - `ИТОГО_СТРОКА` — сумма по строке по всем документным колонкам
  - строка `ИТОГО_СТОЛБЕЦ` — сумма по каждому документу и общий итог
- Веб-интерфейс:
  - кнопки **Загрузить**, **Старт**, **Скачать Excel**
  - окно логов и статус выполнения
- После скачивания Excel:
  - очищаются логи
  - удаляются временные PDF и итоговый Excel
- При закрытии вкладки выполняется попытка остановить dev-сервер (`/shutdown`).

## Требования

- Python 3.10+ (рекомендуется)
- Java (JRE/JDK) — обязательна для `tabula-py`

Проверка Java:
```bash
java -version
```

Установка и запуск

```bash
cd pdf_to_excel
python -m venv .venv
```

# Windows:
`.venv\Scripts\activate`

# Linux/Mac:
`source .venv/bin/activate`

```python
pip install -r requirements.txt
python app.py
```
Открыть в браузере:
http://127.0.0.1:5000
